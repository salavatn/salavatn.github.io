<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>S3 Bucket - NS-Lab</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "S3 Bucket";
        var mkdocs_page_input_path = "AWS/s3-bucket.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> NS-Lab
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Python Libs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Python/Libs/Faker/">Faker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Python/Libs/dotEnv/">DotEnv</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Python ORM</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Python/ORM/SQLAlchemy/sqlalchemy-info/">SQLAlchemy</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Python Framework</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Python/Framework/fastapi/">FastAPI</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Amazon AWS</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">S3 Bucket</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#configure-aws-cli">Configure AWS CLI</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#amazon-s3-examples">Amazon S3 examples</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1-create-new-bucket">1. Create new Bucket</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#simple-code">Simple code:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#code-with-exceptions">Code with exceptions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-get-list-of-bucket">2. Get list of Bucket</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#21-get-via-resource">2.1. Get via RESOURCE:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#22-get-via-client">2.2. Get via CLIENT:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-upload-file-to-bucket">3. Upload file to Bucket</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#upload-via-resource-and-put_object">Upload via "RESOURCE" and "PUT_OBJECT"</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#upload-via-client-and-upload_file">Upload via "CLIENT" and "UPLOAD_FILE"</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#7-check-access-permission">7. Check Access Permission</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DevOPS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../DevOPS/SSH_key/">SSH Key</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../DevOPS/SSH_tmux/">Tmux</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tools</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="#">MkDocs Info</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../mkdocs/info/">About</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../mkdocs/GH-Actions/">GitHub Actions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../mkdocs/ConfigYAMLexamples/">Examples</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">NS-Lab</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Amazon AWS &raquo;</li>
      <li>S3 Bucket</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
    <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Breadcrumb Navigation">
        <a href="../../Python/Framework/fastapi/" class="btn btn-neutral float-left" title="FastAPI"><span class="icon icon-circle-arrow-left" aria-hidden="true"></span> Previous</a>
        <a href="../../DevOPS/SSH_key/" class="btn btn-neutral float-right" title="SSH Key">Next <span class="icon icon-circle-arrow-right" aria-hidden="true"></span></a>
    </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="aws">AWS</h1>
<p>You will learn "How to":
1. Create new Bucket
2. Get list Bucket
    - Get via RESOURCE
    - Get via CLIENT
3. Upload file to Bucket
- Check uploaded files
- Delete file from Bucket
- Delete Bucket
4. Check Access Permission</p>
<p>Before using <strong>Boto3</strong>, you need to set up authentication credentials for your AWS account using either the IAM Console or the <strong>AWS CLI</strong>. You can either choose an existing user or create a new one.</p>
<p>For instructions about how to create a user using the IAM Console, see Creating IAM users. Once the user has been created, see Managing access keys to learn how to create and retrieve the keys used to authenticate the user.</p>
<h2 id="configure-aws-cli">Configure AWS CLI</h2>
<pre><code class="language-sh">pip install awscli
aws configure
</code></pre>
<pre><code class="language-output">AWS Access Key ID [none]:     ****************VQNB 
AWS Secret Access Key [none]: ****************AMAm 
Default region name [none]:   eu-central-1
Default output format [none]: json
</code></pre>
<h2 id="amazon-s3-examples">Amazon S3 examples</h2>
<p>https://boto3.amazonaws.com/v1/documentation/api/latest/guide/s3-examples.html</p>
<h2 id="1-create-new-bucket">1. Create new Bucket</h2>
<h3 id="simple-code">Simple code:</h3>
<pre><code class="language-python">import boto3

bucket_name = &quot;new-storage4&quot;
region = &quot;eu-central-1&quot;

s3 = boto3.client('s3', region_name=region)

location = {'LocationConstraint': region}
s3.create_bucket(Bucket=bucket_name, CreateBucketConfiguration=location)
</code></pre>
<h3 id="code-with-exceptions">Code with exceptions</h3>
<pre><code class="language-python">import logging
import boto3
from botocore.exceptions import ClientError


def create_bucket(bucket_name, region=None):
    &quot;&quot;&quot;
    Create an S3 bucket in a specified region
    :param bucket_name: Bucket name
    :param region: set region, example: us-west-2
    :return: True if bucket created, else False
    &quot;&quot;&quot;

    try:
        if region is None:
            s3_client = boto3.client('s3')
            s3_client.create_bucket(Bucket=bucket_name)
        else:
            s3_client = boto3.client('s3', region_name=region)
            location = {'LocationConstraint': region}
            s3_client.create_bucket(Bucket=bucket_name,
                                    CreateBucketConfiguration=location)
    except ClientError as error:
        logging.error(error)
        return False
    return True


create_bucket(&quot;new-storage3&quot;, &quot;eu-central-1&quot;)
</code></pre>
<h2 id="2-get-list-of-bucket">2. Get list of Bucket</h2>
<h3 id="21-get-via-resource">2.1. Get via RESOURCE:</h3>
<pre><code class="language-python">import boto3

s3 = boto3.resource('s3')

print('Existing buckets:')
for bucket in s3.buckets.all():
    print(f&quot;\t{bucket.name}&quot;)
</code></pre>
<pre><code class="language-output">Existing buckets:
    new-storage3
    ns-lab-web
    ns-lab.open-storage
</code></pre>
<h3 id="22-get-via-client">2.2. Get via CLIENT:</h3>
<pre><code class="language-python">import boto3

s3 = boto3.client('s3')
response = s3.list_buckets()

print('Existing buckets:')
for bucket in response['Buckets']:
    print(f'\t\t{bucket[&quot;Name&quot;]}')
</code></pre>
<pre><code class="language-output">Existing buckets:
    new-storage3
    ns-lab-web
    ns-lab.open-storage
</code></pre>
<h2 id="3-upload-file-to-bucket">3. Upload file to Bucket</h2>
<h3 id="upload-via-resource-and-put_object">Upload via "RESOURCE" and "PUT_OBJECT"</h3>
<pre><code class="language-python">import boto3

bucket_name = 'new-storage3'
filepath = '/home/salavat/Pictures/picture.jpg'
filename = 'photo-6.jpg'

s3 = boto3.resource('s3')

file = open(filepath, 'rb')
bucket = s3.Bucket(bucket_name)
bucket.put_object(Key=filename, Body=file)
</code></pre>
<h3 id="upload-via-client-and-upload_file">Upload via "CLIENT" and "UPLOAD_FILE"</h3>
<pre><code class="language-python">import boto3

bucket_name = 'new-storage3'
filepath = '/home/salavat/Pictures/picture.jpg'
filename = 'photo-7.jpg'

s3 = boto3.client('s3')

s3.upload_file(filepath, bucket_name, filename)
</code></pre>
<h2 id="7-check-access-permission">7. Check Access Permission</h2>
<pre><code class="language-python">import boto3

# Retrieve a bucket's ACL
s3 = boto3.client('s3')
result = s3.get_bucket_acl(Bucket='ns-lab-web')

print(result)
print(f&quot;Permission:\t{result['Grants'][0]['Permission']}&quot;)
</code></pre>
<pre><code class="language-output">{'ResponseMetadata': {'RequestId': '0KH7CJF83GB8TE4W', 'HostId': '+mqxBWKk4+INjELAEg+pICxfT8cDEU0/CpZPAbYeDUWGo3t6XfkoCb/RiL4Tb6GH90vk+x/bNaM=', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amz-id-2': '+mqxBWKk4+INjELAEg+pICxfT8cDEU0/CpZPAbYeDUWGo3t6XfkoCb/RiL4Tb6GH90vk+x/bNaM=', 'x-amz-request-id': '0KH7CJF83GB8TE4W', 'date': 'Wed, 15 Feb 2023 21:11:46 GMT', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'server': 'AmazonS3'}, 'RetryAttempts': 1}, 'Owner': {'ID': 'a832a8b8a4e6cf3a0ca798daa02b087110234b6db836b61904789188f9615fb0'}, 'Grants': [{'Grantee': {'ID': 'a832a8b8a4e6cf3a0ca798daa02b087110234b6db836b61904789188f9615fb0', 'Type': 'CanonicalUser'}, 'Permission': 'FULL_CONTROL'}]}
Permission: FULL_CONTROL
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../Python/Framework/fastapi/" class="btn btn-neutral float-left" title="FastAPI"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../DevOPS/SSH_key/" class="btn btn-neutral float-right" title="SSH Key">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../Python/Framework/fastapi/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../DevOPS/SSH_key/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
